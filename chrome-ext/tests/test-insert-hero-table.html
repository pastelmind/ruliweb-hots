<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Insertable hero table test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./css/ruliweb.css">
  <link rel="stylesheet" href="../templates/css/insert-tables.css">
</head>

<body>
  <script src="../../node_modules/mustache/mustache.min.js"></script>
  <script src="./js/mocks.js"></script>
  <script src="../src/js/decorate-hots-data.js"></script>
  <script src="../src/js/hots-dialog.js"></script>
  <script src="../src/js/hots-dialog-renderers.js"></script>
  <script src="../src/js/hots-dialog-util.js"></script>
  <script>
    (async function main() {
      const jsonPath = '../../docs/hots.json';
      const response = await fetch(jsonPath);
      if (!response.ok)
        throw new Error(`Cannot retrieve ${jsonPath}: ${response.status} ${response.statusText}`);

      const hotsData = await response.json();
      decorateHotsData(hotsData);

      const template = document.createElement('template');

      const heroIds = [
        'Cho',
        'Gall',
        'Fenix',
        'SgtHammer',
        'Greymane',
        'Probius',
        'Guldan',
        'DVa',
        'Zarya',
        'Valeera',
        'Medic',
        'Auriel',
        'Tracer',
        'Junkrat',
        'Rexxar',
        'LostVikings',
      ];

      for (const heroId of heroIds) {
        if (heroId in hotsData.heroes)
          template.innerHTML += HotsDialog.renderers.renderHeroInfoTable(hotsData.heroes[heroId], 64, 48, undefined);
        else
          console.error('Cannot find hero ID:', heroId);
      }

      for (const detailsElement of template.content.querySelectorAll('details.ruliweb-hots-hero-table'))
        detailsElement.open = true;

      document.body.appendChild(template.content);

    })();
  </script>
</body>

</html>