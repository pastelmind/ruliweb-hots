{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Heroes of the Storm dataset for Ruliweb-HotS",
  "type": "object",
  "properties": {
    "hotsVersion": {
      "description": "Heroes of the Storm patch version on which the current dataset is based",
      "type": "string",
      "pattern": "^\\d+(\\.\\d+){1,2}$"
    },
    "statPresets": {
      "type": "object",
      "additionalItems": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "iconUrl": {
            "type": "string",
            "format": "uri"
          },
          "isDisabled": {
            "type": "boolean"
          }
        },
        "required": [
          "name",
          "iconUrl"
        ],
        "additionalProperties": false
      }
    },
    "heroes": {
      "description": "Collection of hero data",
      "type": "object",
      "propertyNames": {
        "pattern": "^[a-z\\-\\.]+$"
      },
      "minProperties": 80,
      "maxProperties": 80,
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": {
            "$comment": "TODO: Add separate properties for English/Korean names of heroes, skills, and talents",
            "$ref": "#/definitions/trimmedString"
          },
          "iconUrl": {
            "type": "string",
            "format": "uri"
          },
          "type": {
            "type": "string",
            "enum": [
              "근접",
              "원거리",
              "근접 / 원거리"
            ]
          },
          "role": {
            "type": "string",
            "pattern": "^(warrior|assassin|support|specialist)(,(warrior|assassin|support|specialist))*$"
          },
          "universe": {
            "type": "string",
            "enum": [
              "warcraft",
              "starcraft",
              "diablo",
              "classic",
              "overwatch"
            ]
          },
          "stats": {
            "description": "Collection of the hero's units (unit === collection of stats)",
            "type": [
              "object",
              "array"
            ],
            "oneOf": [
              {
                "allOf": [
                  {
                    "$ref": "#/definitions/unit"
                  },
                  {
                    "not": {
                      "required": [
                        "unitName"
                      ]
                    }
                  }
                ]
              },
              {
                "type": "array",
                "items": {
                  "allOf": [
                    {
                      "$ref": "#/definitions/unit"
                    },
                    {
                      "required": [
                        "unitName"
                      ]
                    }
                  ]
                },
                "minItems": 2,
                "maxItems": 4
              }
            ]
          },
          "skills": {
            "description": "Collection of a hero's basic skills (available at level 0)",
            "type": "array",
            "items": {
              "$ref": "#/definitions/skill"
            },
            "minItems": 1
          },
          "talents": {
            "description": "Collection of a hero's talents grouped by unlock level",
            "type": "object",
            "propertyNames": {
              "pattern": "^([1-9]|1\\d|20)$"
            },
            "additionalProperties": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/talent"
              },
              "minItems": 1
            }
          }
        },
        "required": [
          "name",
          "type",
          "role",
          "universe",
          "stats",
          "skills",
          "talents"
        ]
      }
    }
  },
  "required": [
    "hotsVersion",
    "heroes"
  ],
  "definitions": {
    "unit": {
      "description": "Represents a unit, which is a collection of stats",
      "type": "object",
      "properties": {
        "unitName": {
          "type": "string"
        },
        "hp": {
          "$ref": "#/definitions/scalingDecimalStat"
        },
        "hpRegen": {
          "type": "object",
          "properties": {
            "value": {
              "type": "number",
              "multipleOf": 0.0001
            },
            "levelScaling": {
              "type": "number",
              "multipleOf": 0.005
            }
          }
        },
        "mp": {
          "oneOf": [
            {
              "type": "object",
              "properties": {
                "value": {
                  "type": "integer",
                  "exclusiveMinimum": 0
                },
                "levelAdd": {
                  "type": "integer",
                  "exclusiveMinimum": 0
                }
              }
            },
            {
              "type": "integer",
              "exclusiveMinimum": 0
            }
          ]
        },
        "mpRegen": {
          "type": "object",
          "properties": {
            "value": {
              "type": "number",
              "multipleOf": 1
            },
            "levelAdd": {
              "type": "number",
              "multipleOf": 0.001
            }
          }
        },
        "chargeRegen": {
          "type": "number",
          "multipleOf": 0.0001
        },
        "radius": {
          "type": "number",
          "multipleOf": 0.0625
        },
        "damage": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "allOf": [
                  {
                    "$ref": "#/definitions/scalingDecimalStat"
                  },
                  {
                    "properties": {
                      "altName": {
                        "type": "string"
                      }
                    }
                  }
                ]
              },
              "minItems": 2,
              "maxItems": 2
            },
            {
              "$ref": "#/definitions/scalingDecimalStat"
            }
          ]
        },
        "range": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "altName": {
                    "type": "string"
                  },
                  "value": {
                    "type": "number",
                    "multipleOf": 0.25
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "minItems": 2,
              "maxItems": 2
            },
            {
              "type": "number",
              "multipleOf": 0.25
            }
          ]
        },
        "period": {
          "oneOf": [
            {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "altName": {
                    "type": "string"
                  },
                  "value": {
                    "type": "number",
                    "multipleOf": 0.0001
                  }
                },
                "required": [
                  "value"
                ],
                "additionalProperties": false
              },
              "minItems": 2,
              "maxItems": 2
            },
            {
              "type": "number",
              "multipleOf": 0.0001
            }
          ]
        },
        "speed": {
          "type": "number",
          "multipleOf": 0.0001
        }
      },
      "patternProperties": {
        "^(shields|healEnergy)$": {
          "$ref": "#/definitions/scalingIntegerStat"
        },
        "^(charge|energy|energyRegen|zaryaEnergy|fury|brew|ammo)$": {
          "type": "integer",
          "exclusiveMinimum": 0
        }
      },
      "required": [
        "hp",
        "hpRegen",
        "radius",
        "speed"
      ],
      "dependencies": {
        "hpRegen": [
          "hp"
        ],
        "mpRegen": [
          "mp"
        ],
        "energyRegen": [
          "energy"
        ]
      },
      "additionalProperties": false
    },
    "scalingDecimalStat": {
      "type": "object",
      "properties": {
        "value": {
          "type": "number",
          "multipleOf": 0.1
        },
        "levelScaling": {
          "type": "number",
          "multipleOf": 0.005
        }
      }
    },
    "scalingIntegerStat": {
      "type": "object",
      "properties": {
        "value": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "levelScaling": {
          "type": "number",
          "multipleOf": 0.005
        }
      }
    },
    "talent": {
      "description": "Represents a talent",
      "type": "object",
      "properties": {
        "name": {
          "$ref": "#/definitions/trimmedString"
        },
        "type": {
          "$ref": "#/definitions/trimmedString"
        },
        "iconUrl": {
          "type": "string",
          "format": "uri"
        },
        "description": {
          "allOf": [
            {
              "$ref": "#/definitions/trimmedString"
            },
            {
              "description": "All newlines must be normalized to LF",
              "not": {
                "pattern": "\\r"
              }
            },
            {
              "description": "Each line must be trimmed",
              "not": {
                "pattern": " \\n|\\n "
              }
            }
          ]
        },
        "cooldown": {
          "type": "number",
          "exclusiveMinimum": 0,
          "multipleOf": 0.5
        },
        "rechargeCooldown": {
          "type": "number",
          "exclusiveMinimum": 0,
          "multipleOf": 0.5
        },
        "manaCost": {
          "$comment": "TODO: Convert all strings (X per second) to numbers",
          "type": [
            "integer",
            "string"
          ],
          "exclusiveMinimum": 0
        },
        "manaCostPerSecond": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "extras": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/trimmedString"
          },
          "propertyNames": {
            "$ref": "#/definitions/trimmedString"
          }
        }
      },
      "required": [
        "name",
        "type",
        "iconUrl",
        "description"
      ],
      "additionalProperties": false
    },
    "skill": {
      "description": "Represents a talent",
      "allOf": [
        {
          "$ref": "#/definitions/talent"
        },
        {
          "properties": {
            "type": {
              "$comment": "TODO: Use 'D' instead of '고유 능력'",
              "enum": [
                "Q",
                "W",
                "E",
                "R",
                "고유 능력",
                "Z",
                "1"
              ]
            }
          }
        }
      ]
    },
    "trimmedString": {
      "type": "string",
      "minLength": 1,
      "pattern": "^\\S([^]*\\S)?$"
    }
  }
}